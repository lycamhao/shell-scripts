com.cathayins.ir.t0.batch.IRT0_9304.SELECT_DTIRD682_AGG=WITH D682 AS (
SELECT 
         CAL_YYMM,
         TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_POLICY_CODE,
         PRODUCT_MAIN_ID,
         PORT_NO,
         GROUP_NO,
         DT_PERIOD,
         SUM(AMOUNT) AS AMOUNT,
         SUM(AMOUNT_TWD) AS AMOUNT_TWD,
         SUM(PREMIUM) AS PREMIUM,
         SUM(PREMIUM_TWD) AS PREMIUM_TWD
FROM     DBIR.DTIRD682
WHERE    CAL_YYMM <= ':CAL_YYMM'
AND      CAL_YYMM >= ':BASE_YYMM'
AND      TTY_YEAR=':TTY_YEAR'
AND      TTY_NO =':TTY_NO'
AND      PRODUCT_CODE = ':PRODUCT_CODE'
AND      PRODUCT_MAIN_ID=':PRODUCT_MAIN_ID'
AND      PORT_NO = ':PORT_NO'
AND      GROUP_NO = ':GROUP_NO'
GROUP BY 
         CAL_YYMM,
         TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_POLICY_CODE,
         PRODUCT_MAIN_ID,
         PORT_NO,
         GROUP_NO,
         DT_PERIOD
)
SELECT   
         D682.CAL_YYMM,
         D682.TTY_YEAR,
         D682.TTY_NO,
         D682.PRODUCT_CODE,
         D682.PRODUCT_POLICY_CODE,
         D682.PRODUCT_MAIN_ID,
         D682.PORT_NO,
         D682.GROUP_NO,
         'T' AS REINS_KIND,
         'TWD' AS CURRENCY,
         '30' AS CAL_DAYS,
         SUM(D682.AMOUNT) AS TOTAL_AMOUNT,
         SUM(D682.AMOUNT_TWD) AS TOTAL_AMOUNT_TWD,
         SUM(D682.PREMIUM) AS TOTAL_PREMIUM,
         SUM(D682.PREMIUM_TWD) AS TOTAL_PREMIUM_TWD,
         STRING_AGG(TO_CHAR(D682.DT_PERIOD, 'YYYY-MM-DD')||':'||D682.AMOUNT, ',' ORDER BY D682.DT_PERIOD) AS AMOUNT_STR,
         STRING_AGG(TO_CHAR(D682.DT_PERIOD, 'YYYY-MM-DD')||':'||D682.AMOUNT_TWD, ',' ORDER BY D682.DT_PERIOD) AS AMOUNT_TWD_STR,
         STRING_AGG(TO_CHAR(D682.DT_PERIOD, 'YYYY-MM-DD')||':'||D682.PREMIUM, ',' ORDER BY D682.DT_PERIOD) AS PREMIUM_STR,
         STRING_AGG(TO_CHAR(D682.DT_PERIOD, 'YYYY-MM-DD')||':'||D682.PREMIUM_TWD, ',' ORDER BY D682.DT_PERIOD) AS PREMIUM_TWD_STR
FROM     D682
GROUP BY 
         D682.CAL_YYMM,
         D682.TTY_YEAR,
         D682.TTY_NO,
         D682.PRODUCT_CODE,
         D682.PRODUCT_POLICY_CODE,
         D682.PRODUCT_MAIN_ID,
         D682.PORT_NO,
         D682.GROUP_NO
ORDER BY 
         D682.CAL_YYMM,
         D682.TTY_YEAR,
         D682.TTY_NO,
         D682.PRODUCT_CODE,
         D682.PRODUCT_POLICY_CODE,
         D682.PRODUCT_MAIN_ID,
         D682.PORT_NO,
         D682.GROUP_NO
-- WITH UR, 
com.cathayins.ir.t0.batch.IRT0_9307.SELECT_DTIRD605=WITH D605A AS (
SELECT   TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_MAIN_ID,
         'TWD' as CURRENCY,
         RI_PORT_NO,
         RI_GROUP_NO,
         CASE WHEN RIGHT(REINS_AC_DATE,2) in ('01','02','03') THEN '1'
              WHEN RIGHT(REINS_AC_DATE,2) in ('04','05','06') THEN '2'
              WHEN RIGHT(REINS_AC_DATE,2) in ('07','08','09') THEN '3'
              WHEN RIGHT(REINS_AC_DATE,2) in ('10','11','12') THEN '4'
         END SEASON,
         LEFT(REINS_AC_DATE,4) AS SEASON_YEAR,
         premium_twd as REINS_PREMIUM,
         flat_commisn_twd as REINS_COMMISN,
         var_commisn_twd as PROVISIONAL_COMMISSION_TWD,
         '0' AS TYPE         
FROM    DBIR.DTIRD603
WHERE    CAL_YYMM <= ':CAL_YYMM'
AND      CAL_YYMM >= ':BASE_YYMM'
AND      TTY_TYPE NOT IN ('RT', 'XOL')
AND      ((ri_cohort >= '2024' AND ri_mesur_mod = '1') OR ri_cohort < '2024')
AND      NOT (product_code = 'C' and left(ri_group_no, 4) in ('3014', '3015', '3016', '3032'))
AND      NOT (product_code = 'F' and left(ri_group_no, 4) in ('3029'))
[ AND     TTY_YEAR = ':TTY_YEAR' ]
[ AND     TTY_NO = ':TTY_NO' ]
[ AND     PRODUCT_CODE = ':PRODUCT_CODE' ]

union
--2:�j���I
SELECT   TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_MAIN_ID,
         'TWD' as CURRENCY,
         RI_PORT_NO,
         RI_GROUP_NO,
         RIGHT(CAL_YYMM,2) AS SEASON,
         LEFT(CAL_YYMM,4) AS SEASON_YEAR,
         premium_twd as REINS_PREMIUM,
         flat_commisn_twd as REINS_COMMISN,
         var_commisn_twd as PROVISIONAL_COMMISSION_TWD,
         '2' AS TYPE         
FROM    DBIR.DTIRD603
WHERE    CAL_YYMM <= ':CAL_YYMM'
AND      CAL_YYMM >= '202311'
AND      TTY_TYPE NOT IN ('RT', 'XOL')
AND      ((ri_cohort >= '2024' AND ri_mesur_mod = '1') OR ri_cohort < '2024')
AND      (product_code = 'C' and left(ri_group_no, 4) in ('3014', '3015', '3016', '3032'))
[ AND     TTY_YEAR = ':TTY_YEAR' ]
[ AND     TTY_NO = ':TTY_NO' ]
[ AND     PRODUCT_CODE = ':PRODUCT_CODE' ]

union
--1:�a�_�I 
SELECT   TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_MAIN_ID,
         'TWD' as CURRENCY,
         RI_PORT_NO,
         RI_GROUP_NO,
         RIGHT(CAL_YYMM,2) AS SEASON,
         LEFT(CAL_YYMM,4) AS SEASON_YEAR,
         premium_twd as REINS_PREMIUM,
         flat_commisn_twd as REINS_COMMISN,
         var_commisn_twd as PROVISIONAL_COMMISSION_TWD,
         '1' AS TYPE         
FROM    DBIR.DTIRD603
WHERE    CAL_YYMM <= ':CAL_YYMM'
AND      CAL_YYMM >= ':BASE_YYMM'
AND      TTY_TYPE NOT IN ('RT', 'XOL')
AND      ((ri_cohort >= '2024' AND ri_mesur_mod = '1') OR ri_cohort < '2024')
AND      (product_code = 'F' and left(ri_group_no, 4) in ('3029'))
[ AND     TTY_YEAR = ':TTY_YEAR' ]
[ AND     TTY_NO = ':TTY_NO' ]
[ AND     PRODUCT_CODE = ':PRODUCT_CODE' ]

),
D605B AS (
SELECT   TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_MAIN_ID,
         CURRENCY,
         RI_PORT_NO,
         RI_GROUP_NO,
         SEASON,
         SEASON_YEAR,
         TYPE,
         SUM(COALESCE(REINS_PREMIUM, 0)) AS PREMIUM,
         SUM(COALESCE(REINS_COMMISN, 0)) AS FLAT_COMMISN,
		 SUM(COALESCE(PROVISIONAL_COMMISSION_TWD, 0)) AS PROVISIONAL_COMMISSION
FROM    D605A
GROUP BY TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_MAIN_ID,
         CURRENCY,
         RI_PORT_NO,
         RI_GROUP_NO,
         SEASON,
         SEASON_YEAR,
         TYPE
)
SELECT   ':CAL_YYMM' as CAL_YYMM,
         TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_MAIN_ID,
         CURRENCY,
         RI_PORT_NO,
         RI_GROUP_NO,
         TYPE,
         STRING_AGG(SEASON_YEAR||':'||SEASON||':'||PREMIUM||':'||FLAT_COMMISN||':'||PROVISIONAL_COMMISSION,',' ORDER BY SEASON) AS SEASON_STR
FROM    D605B
GROUP BY TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_MAIN_ID,
         CURRENCY,
         RI_PORT_NO,
         RI_GROUP_NO,
         TYPE
-- WITH UR, 
com.cathayins.ir.t0.batch.IRT0_9304.INSERT_DTIRD600=INSERT INTO DBIR.DTIRD600 (
    CAL_YYMM,
    TTY_YEAR,
    TTY_NO,
    PRODUCT_CODE,
    PRODUCT_POLICY_CODE,
    PRODUCT_MAIN_ID,
    CURRENCY,
    MESUR_MOD,
    PROFIT_KIND,
    COHORT,
    PORT_NO,
    GROUP_NO,
    TTY_TYPE,
    INTERNAL_OR_OVERSEAS,
    BASE_DATE,
    START_DATETIME,
    END_DATETIME,
    PROTECT_START_DATETIME,
    PROTECT_END_DATETIME,
    CLAIM_YEARS,
    SBACC_CODE,
    SBACC_CODE_NAME,
    EXCHANGE_RATE,
    AMOUNT,
    AMOUNT_TWD,
    PREMIUM,
    PREMIUM_TWD,
    FLAT_COMMISN,
    FLAT_COMMISN_TWD,
    VAR_COMMISN,
    VAR_COMMISN_TWD,
    TRN_SER_NO,
    SLIP_LOT_NO,
    SLIP_SET_NO,
    CREATE_ID,
    CREATE_DATE_TIME
) VALUES(
    ':CAL_YYMM',
    ':TTY_YEAR',
    ':TTY_NO',
    ':PRODUCT_CODE',
    ':PRODUCT_POLICY_CODE',
    ':PRODUCT_MAIN_ID',
    ':CURRENCY',
    ':MESUR_MOD',
    ':PROFIT_KIND',
    ':COHORT',
    ':PORT_NO',
    ':GROUP_NO',
    ':TTY_TYPE',
    ':INTERNAL_OR_OVERSEAS',
    CAST(':BASE_DATE' AS DATE),
    ':START_DATETIME',
    ':END_DATETIME',
    ':PROTECT_START_DATETIME',
    ':PROTECT_END_DATETIME',
    CAST(':CLAIM_YEARS' AS INTEGER),
    ':SBACC_CODE',
    ':SBACC_CODE_NAME',
    CAST(':EXCHANGE_RATE' AS NUMERIC(9, 4)),
    CAST(':AMOUNT' AS NUMERIC(26, 5)),
    CAST(':AMOUNT_TWD' AS NUMERIC(26, 5)),
    CAST(':PREMIUM' AS NUMERIC(26, 5)),
    CAST(':PREMIUM_TWD' AS NUMERIC(26, 5)),
    CAST(':FLAT_COMMISN' AS NUMERIC(26, 5)),
    CAST(':FLAT_COMMISN_TWD' AS NUMERIC(26, 5)),
    CAST(':VAR_COMMISN' AS NUMERIC(26, 5)),
    CAST(':VAR_COMMISN_TWD' AS NUMERIC(26, 5)),
    ':TRN_SER_NO',
    ':SLIP_LOT_NO',
    ':SLIP_SET_NO',
    ':CREATE_ID',
    ':CREATE_DATE_TIME'
), 
com.cathayins.ir.t0.batch.IRT0_9304.UPADTE_DTIRD600_SET_PREMIUM_TO_ZERO=WITH D610 AS (
SELECT 
       TTY_YEAR, TTY_NO, PRODUCT_MAIN_ID, GROUP_NO
FROM DBIR.DTIRD610
WHERE DACNT_DATE BETWEEN ':CAL_START_DATE' AND ':CAL_END_DATE'
AND PRODUCT_CODE = 'C'
AND LEFT(GROUP_NO, 4) IN ('3014', '3015', '3016', '3032')
)
UPDATE DBIR.DTIRD600 D600
SET PREMIUM = 0, 
    PREMIUM_TWD = 0, 
    CHANGE_ID = ':CHANGE_ID',
    CHANGE_DATE_TIME = ':CHANGE_DATE_TIME'
WHERE D600.CAL_YYMM = ':CAL_YYMM'
AND   D600.PRODUCT_CODE = 'C'
AND   NOT EXISTS(
      SELECT 1 
      FROM  D610
      WHERE D610.TTY_YEAR = D600.TTY_YEAR
      AND   D610.TTY_NO = D600.TTY_NO
      AND   D610.PRODUCT_MAIN_ID = D600.PRODUCT_MAIN_ID
      AND   D610.GROUP_NO = D600.GROUP_NO
)
-- WITH UR, 
com.cathayins.ir.t0.batch.IRT0_9304.SELECT_DTIRD610=WITH C002 AS (
SELECT
       DISPLAY_NAME, 
       DISPLAY_VALUE,
       DATA1
FROM     DBIR.DTIRC002
WHERE    PARAM_ID = 'PRODUCT_MAIN_ID'
ORDER BY DISPLAY_SEQ
)
SELECT
      C002.DISPLAY_NAME AS SBACC_CODE_NAME,
      C002.DATA1 AS SBACC_CODE,
      TTY_YEAR,
      TTY_NO,
      PRODUCT_CODE,
      PRODUCT_POLICY_CODE,
      PRODUCT_MAIN_ID,
      CURRENCY,
      SUBSTR(GROUP_NO, 5, 1) AS MESUR_MOD,
      SUBSTR(GROUP_NO, 18, 1) AS PROFIT_KIND,
      SUBSTR(GROUP_NO, 19, 4) AS COHORT,
      PORT_NO,
      GROUP_NO,
      EXCHANGE_RATE,
      PREMIUM,
      PREMIUM_TWD,
      FLAT_COMMISN,
      FLAT_COMMISN_TWD,
      VAR_COMMISN,
      VAR_COMMISN_TWD,
      TRN_SER_NO,
      SLIP_LOT_NO,
      SLIP_SET_NO
FROM  DBIR.DTIRD610 D610
JOIN  C002 ON C002.DISPLAY_VALUE = D610.PRODUCT_MAIN_ID
WHERE DACNT_DATE BETWEEN ':CAL_START_DATE' AND ':CAL_END_DATE'
AND   PRODUCT_CODE = 'C'
AND   LEFT(GROUP_NO, 4) IN ('3014', '3015', '3016', '3032')
AND   NOT EXISTS(
      SELECT 1 
      FROM DBIR.DTIRD600 D600
      WHERE D600.CAL_YYMM = ':CAL_YYMM'
      AND   D600.PRODUCT_CODE = 'C'
      AND   D610.TTY_YEAR = D600.TTY_YEAR
      AND   D610.TTY_NO = D600.TTY_NO
      AND   D610.PRODUCT_MAIN_ID = D600.PRODUCT_MAIN_ID
      AND   D610.GROUP_NO = D600.GROUP_NO
)
-- WITH UR, 
com.cathayins.ir.t0.batch.IRT0_9304.UPADTE_DTIRD600=WITH D610 AS (
SELECT 
       PREMIUM, PREMIUM_TWD, TTY_YEAR, TTY_NO, PRODUCT_MAIN_ID, GROUP_NO
FROM DBIR.DTIRD610
WHERE DACNT_DATE BETWEEN ':CAL_START_DATE' AND ':CAL_END_DATE'
AND PRODUCT_CODE = 'C'
AND LEFT(GROUP_NO, 4) IN ('3014', '3015', '3016', '3032')
)
UPDATE DBIR.DTIRD600 D600
SET    PREMIUM = D610.PREMIUM, 
       PREMIUM_TWD = D610.PREMIUM_TWD, 
       CHANGE_ID = ':CHANGE_ID' , 
       CHANGE_DATE_TIME = ':CHANGE_DATE_TIME'
FROM   D610
WHERE  D600.CAL_YYMM = ':CAL_YYMM'
AND    D600.PRODUCT_CODE = 'C'
AND    D610.TTY_YEAR = D600.TTY_YEAR
AND    D610.TTY_NO = D600.TTY_NO
AND    D610.PRODUCT_MAIN_ID = D600.PRODUCT_MAIN_ID
AND    D610.GROUP_NO = D600.GROUP_NO
-- WITH UR, 
com.cathayins.ir.t0.batch.IRT0_9304.SELECT_DTIRD682_GROUP=SELECT   
         CAL_YYMM,
         TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_MAIN_ID,
         PORT_NO,
         GROUP_NO
FROM     DBIR.DTIRD682
WHERE    CAL_YYMM <= ':CAL_YYMM'
AND      CAL_YYMM >= ':BASE_YYMM'
[ AND    PRODUCT_CODE = ':PRODUCT_CODE' ]
GROUP BY 
         CAL_YYMM,
         TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_MAIN_ID,
         PORT_NO,
         GROUP_NO
-- WITH UR, 
com.cathayins.ir.t0.batch.IRT0_9304.INSERT_DTIRD602_BK=INSERT INTO DBIR.DTIRD602_BK (
    CAL_YYMM,
    TTY_YEAR,
    TTY_NO,
    PRODUCT_CODE,
    PRODUCT_POLICY_CODE,
    PRODUCT_MAIN_ID,
    CURRENCY,
    MESUR_MOD,
    PROFIT_KIND,
    COHORT,
    PORT_NO,
    GROUP_NO,
    TTY_TYPE,
    INTERNAL_OR_OVERSEAS,
    BASE_DATE,
    REINS_START_DATETIME,
    REINS_END_DATETIME,
    REINS_PROJECT_START_DATETIME,
    REINS_PROJECT_END_DATETIME,
    CLAIM_YEARS,
    SBACC_CODE,
    SBACC_CODE_NAME,
    EXCHANGE_RATE,
    AMOUNT,
    AMOUNT_TWD,
    PREMIUM,
    PREMIUM_TWD,
    FLAT_COMMISN,
    FLAT_COMMISN_TWD,
    VAR_COMMISN,
    VAR_COMMISN_TWD,
    CREATE_ID,
    CREATE_DATE_TIME
) VALUES (
    ':CAL_YYMM',
    ':TTY_YEAR',
    ':TTY_NO',
    ':PRODUCT_CODE',
    ':PRODUCT_POLICY_CODE',
    ':PRODUCT_MAIN_ID',
    ':CURRENCY',
    ':MESUR_MOD',
    ':PROFIT_KIND',
    ':COHORT',
    ':PORT_NO',
    ':GROUP_NO',
    ':TTY_TYPE',
    ':INTERNAL_OR_OVERSEAS',
    CAST(':BASE_DATE' AS date),
    ':REINS_START_DATETIME',
    ':REINS_END_DATETIME',
    ':REINS_PROJECT_START_DATETIME',
    ':REINS_PROJECT_END_DATETIME',
    CAST(':CLAIM_YEARS' AS INTEGER),
    ':SBACC_CODE',
    ':SBACC_CODE_NAME',
    CAST(':EXCHANGE_RATE' AS NUMERIC(9, 4)),
    CAST(':AMOUNT' AS NUMERIC(26, 5)),
    CAST(':AMOUNT_TWD' AS NUMERIC(26, 5)),
    CAST(':PREMIUM' AS NUMERIC(26, 5)),
    CAST(':PREMIUM_TWD' AS NUMERIC(26, 5)),
    CAST(':FLAT_COMMISN' AS NUMERIC(26, 5)),
    CAST(':FLAT_COMMISN_TWD' AS NUMERIC(26, 5)),
    CAST(':VAR_COMMISN' AS NUMERIC(26, 5)),
    CAST(':VAR_COMMISN_TWD' AS NUMERIC(26, 5)),
    ':CREATE_ID',
    ':CREATE_DATE_TIME'
), 
com.cathayins.ir.t0.batch.IRT0_9330.SELECT_DTIRD680=SELECT
         D680.TTY_YEAR,
         D680.TTY_NO,
         D680.PRODUCT_CODE,
         D680.PRODUCT_MAIN_ID,
         D680.PORT_NO,
         D680.GROUP_NO,
         D680.DT_PERIOD,
         D680.PREMIUM_TWD,
         D600.BASE_DATE
FROM     DBIR.DTIRD680 D680
LEFT JOIN  DBIR.DTIRD600 D600
on       D600.TTY_YEAR = D680.TTY_YEAR
and      D600.TTY_NO = D680.TTY_NO
and      D600.PRODUCT_CODE = D680.PRODUCT_CODE
and      D600.PRODUCT_MAIN_ID = D680.PRODUCT_MAIN_ID
and      D600.PORT_NO = D680.PORT_NO
and      D600.GROUP_NO = D680.GROUP_NO
and      D600.CAL_YYMM = D680.CAL_YYMM
WHERE    D680.CAL_YYMM = ':CAL_YYMM'
and      D680.REINS_KIND = ':REINS_KIND'
[ and     D680.PRODUCT_CODE =':PRODUCT_CODE' ]
[ and     D680.TTY_YEAR = ':TTY_YEAR' ]
[ and     D680.TTY_NO = ':TTY_NO' ]
[ and     D680.CREATE_ID = ':CREATE_ID' ]
--with ur, 
com.cathayins.ir.t0.batch.IRT0_9307.SELECT_DTIRD600=SELECT   CAL_YYMM,
         TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_POLICY_CODE,
         PRODUCT_MAIN_ID,
         TTY_TYPE,
         CURRENCY,
         PORT_NO,
         GROUP_NO,
         EXCHANGE_RATE,
         PREMIUM,
         PREMIUM_TWD,
         FLAT_COMMISN,
         FLAT_COMMISN_TWD,
         VAR_COMMISN,
         VAR_COMMISN_TWD,
         REINS_PRODUCT_CODE
FROM     DBIR.DTIRD600
WHERE    CAL_YYMM = ':CAL_YYMM'
AND      CREATE_ID = 'ARP7_9500'
[ AND    TTY_YEAR = ':TTY_YEAR' ]
[ AND    TTY_NO = ':TTY_NO' ]
[ AND    PRODUCT_CODE = ':PRODUCT_CODE' ]
-- WITH UR, 
com.cathayins.ir.t0.batch.IRT0_9304.SELECT_DTIRD602=SELECT   CAL_YYMM,
         TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_POLICY_CODE,
         PRODUCT_MAIN_ID,
         CURRENCY,
         MESUR_MOD,
         PROFIT_KIND,
         COHORT,
         PORT_NO,
         GROUP_NO,
         TTY_TYPE,
         INTERNAL_OR_OVERSEAS,
         BASE_DATE,
         REINS_START_DATETIME AS START_DATETIME,
         REINS_END_DATETIME AS END_DATETIME,
         REINS_PROJECT_START_DATETIME AS PROTECT_START_DATETIME,
         REINS_PROJECT_END_DATETIME AS PROTECT_END_DATETIME,
         CLAIM_YEARS,
         SBACC_CODE,
         SBACC_CODE_NAME,
         EXCHANGE_RATE,
         AMOUNT,
         AMOUNT_TWD,
         PREMIUM,
         PREMIUM_TWD,
         FLAT_COMMISN,
         FLAT_COMMISN_TWD,
         VAR_COMMISN,
         VAR_COMMISN_TWD,
         TRN_SER_NO,
         SLIP_LOT_NO,
         SLIP_SET_NO
FROM     DTIRD602
WHERE    CAL_YYMM = ':CAL_YYMM'
[ AND    PRODUCT_CODE = ':PRODUCT_CODE' ]
-- WITH UR, 
com.cathayins.ir.t0.batch.IRT0_9304.SQL_INSERT_DTIRD68A=INSERT INTO DBIR.DTIRD68A (
         CAL_YYMM,
         TTY_YEAR,
         TTY_NO,
         PRODUCT_CODE,
         PRODUCT_POLICY_CODE,
         PRODUCT_MAIN_ID,
         DT_PERIOD,
         PORT_NO,
         GROUP_NO,
         REINS_KIND,
         CURRENCY,
         CAL_DAYS,
         AMOUNT,
         AMOUNT_TWD,
         PROVID_COVER_UNIT,
         PROVID_COVER_UNIT_TWD,
         REMAIN_COVER_UNIT,
         REMAIN_COVER_UNIT_TWD,
         PREMIUM,
         PREMIUM_TWD,
         MAT_PREMIUM,
         MAT_PREMIUM_TWD,
         UN_PREMIUM,
         UN_PREMIUM_TWD,
         CREATE_ID,
         CREATE_DATE_TIME,
         YEAR_COVER_UNIT,
         YEAR_COVER_UNIT_TWD,
         YEAR_PREMIUM_UNIT,
         YEAR_PREMIUM_UNIT_TWD)
VALUES(
         ':CAL_YYMM',
         ':TTY_YEAR',
         ':TTY_NO',
         ':PRODUCT_CODE',
         ':PRODUCT_POLICY_CODE',
         ':PRODUCT_MAIN_ID',
         CAST(':DT_PERIOD' AS date),
         ':PORT_NO',
         ':GROUP_NO',
         ':REINS_KIND',
         ':CURRENCY',
         ':CAL_DAYS',
         ':AMOUNT',
         ':AMOUNT_TWD',
         ':PROVID_COVER_UNIT',
         ':PROVID_COVER_UNIT_TWD',
         ':REMAIN_COVER_UNIT',
         ':REMAIN_COVER_UNIT_TWD',
         ':PREMIUM',
         ':PREMIUM_TWD',
         ':MAT_PREMIUM',
         ':MAT_PREMIUM_TWD',
         ':UN_PREMIUM',
         ':UN_PREMIUM_TWD',
         ':CREATE_ID',
         ':CREATE_DATE_TIME',
         ':YEAR_COVER_UNIT',
         ':YEAR_COVER_UNIT_TWD',
         ':YEAR_PREMIUM_UNIT',
         ':YEAR_PREMIUM_UNIT_TWD'
)